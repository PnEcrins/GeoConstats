{% extends "base.html" %}

{% block content %}
<div id="map" style="height: 92vh;"></div>
<center>
<h1>Add to map</h1>
    <form action="" method="post" novalidate>
            {{ form.hidden_tag() }}
        <p>
            {{ form.date_attaque.label }}<br>
            {{ form.date_attaque(size=32) }}
            {% for error in form.date_attaque.errors %}
            <span style="color: red;">[{{ error }}]</span>
            {% endfor %}
        </p>
        <p>
            {{ form.date_constat.label }}<br>
            {{ form.date_constat(size=32) }}
            {% for error in form.date_constat.errors %}
            <span style="color: red;">[{{ error }}]</span>
            {% endfor %}
        </p>		
	
        <p>
            {{ form.nom_agent1.label }}<br>
            {{ form.nom_agent1(size=32) }}
            {% for error in form.nom_agent1.errors %}
            <span style="color: red;">[{{ error }}]</span>
            {% endfor %}
        </p>
        <p>
            {{ form.nom_agent2.label }}<br>
            {{ form.nom_agent2(size=32) }}
            {% for error in form.nom_agent2.errors %}
            <span style="color: red;">[{{ error }}]</span>
            {% endfor %}
        </p>
        <p>
            {{ form.proprietaire.label }}<br>
            {{ form.proprietaire(size=32) }}
            {% for error in form.proprietaire.errors %}
            <span style="color: red;">[{{ error }}]</span>
            {% endfor %}
        </p>
        <p>
            {{ form.type_animaux.label }}<br>
            {{ form.type_animaux(size=32) }}
            {% for error in form.type_animaux.errors %}
            <span style="color: red;">[{{ error }}]</span>
            {% endfor %}
        </p>		
        <p>
            {{ form.nb_victimes_mort.label }}<br>
            {{ form.nb_victimes_mort(size=32) }}
            {% for error in form.nb_victimes_mort.errors %}
            <span style="color: red;">[{{ error }}]</span>
            {% endfor %}
        </p>
        <p>
            {{ form.nb_victimes_blesse.label }}<br>
            {{ form.nb_victimes_blesse(size=32) }}
            {% for error in form.nb_victimes_blesse.errors %}
            <span style="color: red;">[{{ error }}]</span>
            {% endfor %}
        </p>			
        <p>
            {{ form.statut.label }}<br>
            {{ form.statut(size=32) }}
            {% for error in form.statut.errors %}
            <span style="color: red;">[{{ error }}]</span>
            {% endfor %}
        </p>		
        <p><a herf="{{url_for('map')}}">{{ form.submit() }}</a></p>
    </form>
</center>
<script>
    var map = L.map('map').setView([44.8, 6.2], 10);
    L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);	
	var marker;
	var addConstat=function(e){
		if(marker==undefined){
            marker = L.marker(e.latlng)
            marker.addTo(map);
            marker.bindPopup("Vous placez un constat ici").openPopup();			
		}
		else{
            map.removeLayer(marker)
            marker = L.marker(e.latlng)
            marker.addTo(map);
            marker.bindPopup("Vous placez un constat ici").openPopup();		
		}
		
	}
	map.on("click",addConstat);
</script>
{% endblock %}